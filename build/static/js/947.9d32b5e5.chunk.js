"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[947],{4947:(e,s,t)=>{t.r(s),t.d(s,{default:()=>i});var a=t(5043),n=t(3051),c=t(4022),r=t(5668),o=t(579);const i=()=>{const e=localStorage.getItem("user"),[s,t]=(0,a.useState)([]),[i,d]=(0,a.useState)(!0);(0,a.useEffect)((()=>{l()}),[]);const l=async()=>{const s=await(0,r.xy)(`history_${e}`);s&&!u(s.timestamp)?(t(s.data),d(!1),console.log("Loaded history from IndexedDB")):p()},u=e=>Date.now()-e>3e5,p=()=>{try{setTimeout((()=>{n.A.get("http://192.168.31.133/update/data").then((s=>{s.data.data?(t(s.data.data),(0,r.dR)(`history_${e}`,{data:s.data.data,timestamp:Date.now()}),d(!1)):"OUT"===s.data.Logout?(localStorage.removeItem("ssid"),d(!1),window.location.reload()):(d(!1),console.warn("Unexpected response structure:",s.data))})).catch((e=>{d(!1),e.response?console.error("API Error:",e.response.status,e.response.data):e.request?console.error("No response from server. Please check your connection."):console.error("Error occurred:",e.message)}))}),1e3)}catch(s){d(!1),console.log(s)}};return(0,o.jsx)("div",{className:"history_account_body",children:i?(0,o.jsx)(c.A,{}):(0,o.jsxs)("center",{children:[(0,o.jsx)("div",{}),(0,o.jsx)("div",{className:"account-subb-part-01",children:(0,o.jsxs)("h1",{children:["Transaction ",(0,o.jsx)("span",{children:"History"})]})}),(0,o.jsx)("div",{className:"account_histor-page-main-cnt-01",children:s.map(((e,s)=>(0,o.jsxs)("div",{className:"account_histor-page-main-cnt-01-sub-cnt-01_01",children:[(0,o.jsxs)("div",{className:"account_histor-page-main-cnt-01-sub-cnt-01_01_sub_div",style:{textAlign:"start"},children:[(0,o.jsxs)("h1",{children:["Debited"===e.type&&("Rupee"===e.tp?"Amount Debited":"Stars Debited"),"Credited"===e.type&&("Rupee"===e.tp?"Amount Credited":"Stars Credited")]}),(0,o.jsx)("span",{className:"account_histor-page-main-cnt-01-sub-cnt-01_01_sub_div_span",children:e.Time})]}),(0,o.jsx)("div",{className:"account_histor-page-main-cnt-01-sub-cnt-01_01_sub_div",children:(0,o.jsxs)("h1",{children:["Debited"===e.type&&(0,o.jsxs)("span",{className:"account_histor-page-main-cnt-01-sub-cnt-01_01_sub_div_deb",children:["Rupee"===e.tp&&(0,o.jsx)("span",{children:"+ \u20b9"})," ",e.rupee," ","Stars"===e.tp&&(0,o.jsx)("span",{children:"Stars"})]}),"Credited"===e.type&&(0,o.jsxs)("span",{className:"account_histor-page-main-cnt-01-sub-cnt-01_01_sub_div_cred",children:["+ \u20b9",e.rupee]})]})})]},s)))}),(0,o.jsx)("div",{style:{height:"50px"}})]})})}}}]);
//# sourceMappingURL=947.9d32b5e5.chunk.js.map