"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[393],{7393:(e,s,n)=>{n.r(s),n.d(s,{default:()=>o});var a=n(5043),t=n(4022),c=n(5668),r=n(579);const o=()=>{const[e,s]=(0,a.useState)([]),[n,o]=(0,a.useState)([]),[d,i]=(0,a.useState)(!0);return(0,a.useEffect)((()=>{const e=async()=>{const e=await(0,c.xy)("cupons_data");var n;!e||(n=e.timestamp,Date.now()-n>6e4)?(()=>{try{setTimeout((()=>{fetch("http://192.168.31.133/get/cupon/get/all/datas").then((e=>e.json())).then((e=>{e.data?((0,c.dR)("cupons_data",{data:e.data,timestamp:Date.now()}),s(e.data),i(!1)):(i(!1),console.warn("Unexpected response structure:",e))})).catch((e=>{i(!1),console.error("Fetch error:",e)}))}),5e3)}catch(e){i(!1),console.error("Unexpected error:",e)}})():(s(e.data),i(!1),console.log("Loaded from IndexedDB"))};e();const n=setInterval((()=>{console.log("Refreshing coupon data..."),e()}),6e4);return()=>clearInterval(n)}),[]),(0,a.useEffect)((()=>{if(0===e.length)return;(async()=>{const s=await(0,c.xy)("cupon_name_cnt");if(s&&Array.isArray(s))o(s),console.log("Loaded usernames from DB");else{const s=[];for(let a=0;a<e.length;a++)try{const e=await fetch(`http://192.168.31.133/get/singel/user/won/data/${a+1}`),n=await e.json();if(n.data){const e={id:a,...n.data};s.push(e)}}catch(n){console.warn("User fetch failed for index",a,n)}o(s),(0,c.dR)("cupon_name_cnt",s)}})()}),[e]),(0,r.jsx)("div",{children:d?(0,r.jsx)(t.A,{}):(0,r.jsxs)("center",{children:[(0,r.jsxs)("div",{className:"Home-cnt-01-sub-01",children:[(0,r.jsxs)("strong",{children:["sta",(0,r.jsx)("span",{children:"W"}),"ro"]}),(0,r.jsx)("hr",{})]}),(0,r.jsx)("div",{className:"cupons_h1-01",children:(0,r.jsx)("h1",{children:"Cupons"})}),(0,r.jsx)("div",{className:"cart-page-main-cnt-02-sub-cnt-01",children:e.map(((e,s)=>{const a=n.find((e=>e.id===s));return(0,r.jsxs)("div",{className:"cart_new_sub_cnt-01",children:[(0,r.jsx)("strong",{children:e.title}),(0,r.jsx)("div",{className:"cart_page_rank_cnt-01",children:(0,r.jsxs)("span",{children:["Rank : ",s+1]})}),(0,r.jsx)("div",{className:"cart_new_sub_cnt-01-img-cnt-01",children:(0,r.jsx)("img",{src:e.img,alt:"Cupon"})}),(0,r.jsx)("span",{className:"cart_new_sub_cnt-01-span-01",children:e.body}),a&&(0,r.jsxs)("div",{className:"cart_new_sub_cnt-01-span-01-span-02",children:[(0,r.jsx)("div",{className:"cart_new_sub_cnt-01-span-01-span-02-top",children:(0,r.jsx)("strong",{children:"claimed"})}),(0,r.jsx)("span",{children:a.username})]})]},s)}))})]})})}}}]);
//# sourceMappingURL=393.d40f65d8.chunk.js.map