{"version":3,"file":"static/js/323.55159151.chunk.js","mappings":"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","sources":["pages/account.js"],"sourcesContent":["import {\r\n  faArrowUpAZ,\r\n  faBank,\r\n  faPlusCircle,\r\n  faArrowDownUpAcrossLine,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport api from \"../pages/api\";\r\nimport Loading from \"../loading\";\r\nimport { getFromDB, saveToDB } from \"../db\"; // assuming you have IndexedDB helper functions\r\nimport Popup from \"./popup\";\r\n\r\nconst Account = () => {\r\n  const [balance, setBalance] = useState([]);\r\n  const [btn1, setBtn1] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [alert, setAlert] = useState(false)\r\n  const [data, setData] = useState([]);\r\n\r\n  const user = localStorage.getItem(\"user\");\r\n\r\n  useEffect(() => {\r\n    getCachedBalance();\r\n  }, []);\r\n\r\n  const getCachedBalance = async () => {\r\n    const cached = await getFromDB(`balance_${user}`);\r\n    if (cached && !isExpired(cached.timestamp)) {\r\n      setBalance(cached.data);\r\n      setBtn1(true);\r\n      setLoading(false);\r\n      console.log(\"Loaded from IndexedDB\");\r\n    } else {\r\n      GetBalance();\r\n    }\r\n  };\r\n\r\n  const isExpired = (timestamp) => {\r\n    const now = Date.now();\r\n    const oneMinute = 1000 * 60 * 5;\r\n    return now - timestamp > oneMinute;\r\n  };\r\n\r\n  const New = async () => {\r\n    try {\r\n      setAlert(false);\r\n\r\n      const valid_to_claim = (await getFromDB(\"new\")) || \"\";\r\n      const refer_ui = (await getFromDB(\"refer_ui\")) || \"\";\r\n\r\n      const res = await api.post(\"https://kalanirdhari.in/get/balance/new/data\", {\r\n        user,\r\n        val_cm: valid_to_claim,\r\n        refer_ui\r\n      });\r\n\r\n      if (res.data.Status === \"OK\") {\r\n        await saveToDB(\"new\", \"no\");\r\n        GetBalance();\r\n      } else if (res.data.Status === \"BAD_REF\") {\r\n        setData(\"Invalid referral\");\r\n        setAlert(true);\r\n      } else {\r\n        setData(\"Amount not Credited\");\r\n        setAlert(true);\r\n      }\r\n\r\n    } catch (error) {\r\n      if (error.response) {\r\n        console.error(\"API Error:\", error.response.status, error.response.data);\r\n      } else if (error.request) {\r\n        console.error(\"No response from server. Please check your connection.\");\r\n      } else {\r\n        console.error(\"Error occurred:\", error.message);\r\n      }\r\n    }\r\n  };\r\n\r\n  const GetBalance = async () => {\r\n    try {\r\n      setTimeout(async () => {\r\n        const res = await api.get(`https://kalanirdhari.in/get/acount/balence`);\r\n        if (res.data.data) {\r\n          setBtn1(true);\r\n          setBalance(res.data.data);\r\n          setLoading(false);\r\n          saveToDB(`balance_${user}`, {\r\n            data: res.data.data,\r\n            timestamp: Date.now(),\r\n          });\r\n        } else if (res.data.Status === \"NO\") {\r\n          setBtn1(false);\r\n          setLoading(false);\r\n        } else if (res.data.Logout === \"OUT\") {\r\n          localStorage.removeItem(\"ssid\");\r\n          window.location.reload();\r\n        } else {\r\n          setLoading(false);\r\n          console.warn(\"Unexpected response structure:\", res.data);\r\n        }\r\n      }, 1000);\r\n    } catch (error) {\r\n      setLoading(false);\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n\r\n  const loadRazorpayScript = () => {\r\n    return new Promise((resolve) => {\r\n      const script = document.createElement(\"script\");\r\n      script.src = \"https://checkout.razorpay.com/v1/checkout.js\";\r\n      script.onload = () => resolve(true);\r\n      script.onerror = () => resolve(false);\r\n      document.body.appendChild(script);\r\n    });\r\n  };\r\n\r\n  const initiatePayment = async () => {\r\n    setAlert(false)\r\n    const res = await loadRazorpayScript();\r\n    if (!res) {\r\n      setData(\"Failed to load Razorpay SDK\");\r\n      setAlert(true)\r\n      return;\r\n    }\r\n\r\n    // ðŸŸ¡ Step 1: Create Order from backend\r\n    const orderData = await fetch(\"https://kalanirdhari.in/create-order\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ amount: 100, user }), // ðŸ’¸ amount in rupees, not paise\r\n    }).then((res) => res.json());\r\n\r\n    const options = {\r\n      key: \"rzp_live_V4tRMNPowzPDU5\", // ðŸ”‘ from Razorpay dashboard\r\n      amount: orderData.amount,\r\n      currency: \"INR\",\r\n      name: \"staWro\",\r\n      description: \"staWro\",\r\n      order_id: orderData.id, // Razorpay order ID from backend\r\n      handler: function (response) {\r\n        GetBalance()\r\n        // ðŸŸ¢ No need to verify manually if webhook is set\r\n        setData(\"Payment successful!\");\r\n        setAlert(true)\r\n        console.log(\"Razorpay Response:\", response);\r\n      },\r\n      prefill: {\r\n        name: user,\r\n      },\r\n      notes: {\r\n        user: user, // ðŸ§  Important: Sent to webhook!\r\n      },\r\n      theme: {\r\n        color: \"#3399cc\",\r\n      },\r\n    };\r\n\r\n    const rzp = new window.Razorpay(options);\r\n    rzp.open();\r\n  };\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n    <div>\r\n      {loading ? <Loading /> : (\r\n        <center>\r\n          <div className=\"Home-cnt-01-sub-01\">\r\n            <strong>\r\n              sta<span>W</span>ro\r\n            </strong>\r\n            <hr />\r\n          </div>\r\n          <div className=\"account-main-cnt-01\">\r\n            <span className=\"account-main-cnt-01-span-01\" onClick={New}>Wallet</span>\r\n            <div className=\"account-main-cnt-01-sub-01\">\r\n              {!btn1 && <button className=\"get_bln\" onClick={() => { window.location.href = '/play' }}>Get Free â‚¹05.00</button>}\r\n              {btn1 && balance.balance && (\r\n                <span className=\"account-main-cnt-01-sub-01-sub-span-01\">\r\n                  Account Balance â‚¹<span>{balance.balance}.00</span>\r\n                </span>\r\n              )}\r\n              <h2>\r\n                {/* add navi */}\r\n                <button className=\"wal_add_more\" onClick={initiatePayment} >\r\n                  Add More\r\n                </button>\r\n\r\n              </h2>\r\n            </div>\r\n          </div>\r\n          <br />\r\n          <div className=\"account-main-cnt-02\">\r\n            <div className=\"account-main-cnt-02-sub-cnt-01\" onClick={() => window.location.href = \"/account/upi\"}>\r\n              <span><FontAwesomeIcon icon={faBank} className=\"account-main-cnt-02-sub-cnt-01-sub-icon-01\" /></span>\r\n              <br /><br />\r\n              <span className=\"account-main-cnt-02-sub-cnt-01-span-01\">AC/UPI</span>\r\n            </div>\r\n            <div className=\"account-main-cnt-02-sub-cnt-01\" onClick={() => window.location.href = \"/account/history\"}>\r\n              <span><FontAwesomeIcon icon={faArrowUpAZ} className=\"account-main-cnt-02-sub-cnt-01-sub-icon-01\" /></span>\r\n              <br /><br />\r\n              <span className=\"account-main-cnt-02-sub-cnt-01-span-01\">History</span>\r\n            </div>\r\n            <div className=\"account-main-cnt-02-sub-cnt-01\" onClick={() => window.location.href = \"/account/pending\"}>\r\n              <span><FontAwesomeIcon icon={faArrowDownUpAcrossLine} className=\"account-main-cnt-02-sub-cnt-01-sub-icon-01\" /></span>\r\n              <br /><br />\r\n              <span className=\"account-main-cnt-02-sub-cnt-01-span-01\">Pending</span>\r\n            </div>\r\n          </div>\r\n        </center>\r\n      )}\r\n\r\n      {alert &&\r\n        <Popup data={data} val={alert} />\r\n      }\r\n\r\n\r\n\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Account;"],"names":["Account","balance","setBalance","useState","btn1","setBtn1","loading","setLoading","alert","setAlert","data","setData","user","localStorage","getItem","useEffect","getCachedBalance","async","cached","getFromDB","isExpired","timestamp","console","log","GetBalance","Date","now","setTimeout","res","api","get","saveToDB","Status","Logout","removeItem","window","location","reload","warn","error","_jsxs","children","_jsx","Loading","className","onClick","valid_to_claim","refer_ui","post","val_cm","response","status","request","message","href","Promise","resolve","script","document","createElement","src","onload","onerror","body","appendChild","orderData","fetch","method","headers","JSON","stringify","amount","then","json","options","key","currency","name","description","order_id","id","handler","prefill","notes","theme","color","Razorpay","open","FontAwesomeIcon","icon","faBank","faArrowUpAZ","faArrowDownUpAcrossLine","Popup","val"],"sourceRoot":""}